(window.webpackJsonp=window.webpackJsonp||[]).push([[92],{450:function(t,s,a){"use strict";a.r(s);var e=a(19),n=Object(e.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"示例-如何在-fluid-中使用-juicefs"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#示例-如何在-fluid-中使用-juicefs"}},[t._v("#")]),t._v(" 示例 - 如何在 Fluid 中使用 JuiceFS")]),t._v(" "),s("h2",{attrs:{id:"背景介绍"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#背景介绍"}},[t._v("#")]),t._v(" 背景介绍")]),t._v(" "),s("p",[t._v("JuiceFS 是一款面向云环境设计的开源高性能共享文件系统，提供完备的 POSIX 兼容性，可将海量低价的云存储作为本地磁盘使用，亦可同时被多台主机同时挂载读写。")]),t._v(" "),s("p",[t._v("如何使用 JuiceFS 可以参考文档 "),s("a",{attrs:{href:"https://juicefs.com/docs/zh/community/quick_start_guide",target:"_blank",rel:"noopener noreferrer"}},[t._v("JuiceFS 快速上手指南"),s("OutboundLink")],1),t._v("。")]),t._v(" "),s("h2",{attrs:{id:"安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[t._v("#")]),t._v(" 安装")]),t._v(" "),s("p",[t._v("您可以从 "),s("a",{attrs:{href:"https://github.com/fluid-cloudnative/fluid/releases",target:"_blank",rel:"noopener noreferrer"}},[t._v("Fluid Releases"),s("OutboundLink")],1),t._v(" 下载最新的 Fluid 安装包。")]),t._v(" "),s("p",[t._v("在 Fluid 的安装 chart values.yaml 中将 "),s("code",[t._v("runtime.juicefs.enable")]),t._v(" 设置为 "),s("code",[t._v("true")]),t._v("，再参考 "),s("RouterLink",{attrs:{to:"/zh/guide/install.html"}},[t._v("安装文档")]),t._v(" 完成安装。并检查 Fluid 各组件正常运行：")],1),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("$ kubectl get po -n fluid-system\nNAME                                         READY   STATUS              RESTARTS   AGE\ncsi-nodeplugin-fluid-ctc4l                   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("/2     Running             "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("          113s\ncsi-nodeplugin-fluid-k7cqt                   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("/2     Running             "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("          113s\ncsi-nodeplugin-fluid-x9dfd                   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("/2     Running             "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("          113s\ndataset-controller-57ddd56b54-9vd86          "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("/1     Running             "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("          113s\nfluid-webhook-84467465f8-t65mr               "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("/1     Running             "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("          113s\njuicefsruntime-controller-56df96b75f-qzq8x   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("/1     Running             "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("          113s\n")])])]),s("p",[t._v("确保 "),s("code",[t._v("juicefsruntime-controller")]),t._v("、"),s("code",[t._v("dataset-controller")]),t._v("、"),s("code",[t._v("fluid-webhook")]),t._v(" 的 pod 以及若干 "),s("code",[t._v("csi-nodeplugin")]),t._v(" pod 正常运行。")]),t._v(" "),s("h2",{attrs:{id:"新建工作环境"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#新建工作环境"}},[t._v("#")]),t._v(" 新建工作环境")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("any-path"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("/juicefs\n$ "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("any-path"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("/juicefs\n")])])]),s("h2",{attrs:{id:"运行示例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#运行示例"}},[t._v("#")]),t._v(" 运行示例")]),t._v(" "),s("p",[t._v("使用 JuiceFS 社区版和云服务版所需字段有所区别，下面分别介绍其使用方法：")]),t._v(" "),s("h3",{attrs:{id:"社区版"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#社区版"}},[t._v("#")]),t._v(" 社区版")]),t._v(" "),s("p",[t._v("在使用 JuiceFS 之前，您需要提供元数据服务（如 Redis）及对象存储服务（如 MinIO）的参数，并创建对应的 secret:")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("kubectl create secret generic jfs-secret "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n    --from-literal"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("metaurl"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("redis://192.168.169.168:6379/1 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n    --from-literal"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("access-key"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("accesskey"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n    --from-literal"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("secret-key"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("secretkey"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),s("p",[t._v("其中：")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("metaurl")]),t._v("：元数据服务的访问 URL (比如 Redis)。更多信息参考"),s("a",{attrs:{href:"https://juicefs.com/docs/zh/community/databases_for_metadata/",target:"_blank",rel:"noopener noreferrer"}},[t._v("这篇文档"),s("OutboundLink")],1),t._v(" 。")]),t._v(" "),s("li",[s("code",[t._v("access-key")]),t._v("：对象存储的 access key。")]),t._v(" "),s("li",[s("code",[t._v("secret-key")]),t._v("：对象存储的 secret key。")])]),t._v(" "),s("p",[s("strong",[t._v("查看待创建的 "),s("code",[t._v("Dataset")]),t._v(" 资源对象")])]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[t._v("$ cat<<EOF "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v("dataset.yaml\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" data.fluid.io/v1alpha1\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Dataset\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" jfsdemo\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("mounts")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" minio\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("mountPoint")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"juicefs:///demo"')]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("options")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("bucket")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<bucket>"')]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("storage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"minio"')]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("encryptOptions")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" metaurl\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("valueFrom")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("secretKeyRef")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n              "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" jfs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("secret\n              "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("key")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" metaurl\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" access"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("key\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("valueFrom")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("secretKeyRef")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n              "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" jfs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("secret\n              "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("key")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" access"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("key\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" secret"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("key\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("valueFrom")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("secretKeyRef")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n              "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" jfs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("secret\n              "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("key")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" secret"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("key\nEOF\n")])])]),s("p",[t._v("其中：")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("mountPoint")]),t._v("：指的是 JuiceFS 的子目录，是用户在 JuiceFS 文件系统中存储数据的目录，以 "),s("code",[t._v("juicefs://")]),t._v(" 开头；如 "),s("code",[t._v("juicefs:///demo")]),t._v(" 为 JuiceFS 文件系统的 "),s("code",[t._v("/demo")]),t._v(" 子目录。")]),t._v(" "),s("li",[s("code",[t._v("bucket")]),t._v("：Bucket URL。例如使用 S3 作为对象存储，bucket 为 "),s("code",[t._v("https://myjuicefs.s3.us-east-2.amazonaws.com")]),t._v("；更多信息参考"),s("a",{attrs:{href:"https://juicefs.com/docs/zh/community/how_to_setup_object_storage/",target:"_blank",rel:"noopener noreferrer"}},[t._v("这篇文档"),s("OutboundLink")],1),t._v(" 。")]),t._v(" "),s("li",[s("code",[t._v("storage")]),t._v("：对象存储类型，比如 "),s("code",[t._v("s3")]),t._v("，"),s("code",[t._v("gs")]),t._v("，"),s("code",[t._v("oss")]),t._v("。更多信息参考"),s("a",{attrs:{href:"https://juicefs.com/docs/zh/community/how_to_setup_object_storage/",target:"_blank",rel:"noopener noreferrer"}},[t._v("这篇文档"),s("OutboundLink")],1),t._v(" 。")])]),t._v(" "),s("blockquote",[s("p",[s("strong",[t._v("注意")]),t._v("：只有 "),s("code",[t._v("name")]),t._v(" 和 "),s("code",[t._v("metaurl")]),t._v(" 为必填项，若 JuiceFS 已经格式化过，只需要填写 "),s("code",[t._v("name")]),t._v(" 和 "),s("code",[t._v("metaurl")]),t._v(" 即可。")])]),t._v(" "),s("p",[t._v("由于 JuiceFS 采用的是本地缓存，对应的 "),s("code",[t._v("Dataset")]),t._v(" 只支持一个 mount，且 JuiceFS 没有 UFS，"),s("code",[t._v("mountPoint")]),t._v(" 中可以指定需要挂载的子目录（"),s("code",[t._v("juicefs:///")]),t._v(" 为根路径），会作为根目录挂载到容器内。")]),t._v(" "),s("p",[s("strong",[t._v("创建 "),s("code",[t._v("Dataset")]),t._v(" 资源对象")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("$ kubectl create -f dataset.yaml\ndataset.data.fluid.io/jfsdemo created\n")])])]),s("p",[s("strong",[t._v("查看 "),s("code",[t._v("Dataset")]),t._v(" 资源对象状态")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("$ kubectl get dataset jfsdemo\nNAME      UFS TOTAL SIZE   CACHED   CACHE CAPACITY   CACHED PERCENTAGE   PHASE      AGE\njfsdemo                                                                  NotBound   44s\n")])])]),s("p",[t._v("如上所示，"),s("code",[t._v("status")]),t._v(" 中的 "),s("code",[t._v("phase")]),t._v(" 属性值为 "),s("code",[t._v("NotBound")]),t._v("，这意味着该 "),s("code",[t._v("Dataset")]),t._v(" 资源对象目前还未与任何 "),s("code",[t._v("JuiceFSRuntime")]),t._v(" 资源对象绑定，接下来，我们将创建一个 "),s("code",[t._v("JuiceFSRuntime")]),t._v(" 资源对象。")]),t._v(" "),s("p",[s("strong",[t._v("查看待创建的 "),s("code",[t._v("JuiceFSRuntime")]),t._v(" 资源对象")])]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[t._v("$ cat<<EOF "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v("runtime.yaml\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" data.fluid.io/v1alpha1\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" JuiceFSRuntime\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" jfsdemo\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("replicas")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("tieredstore")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("levels")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("mediumtype")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" MEM\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("path")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" /dev/shm\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("quota")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("40960")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("low")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0.1"')]),t._v("\nEOF\n")])])]),s("blockquote",[s("p",[t._v("注意：JuiceFS 中 "),s("code",[t._v("quota")]),t._v(" 的最小单位是 MiB")])]),t._v(" "),s("p",[s("strong",[t._v("创建 "),s("code",[t._v("JuiceFSRuntime")]),t._v(" 资源对象")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("$ kubectl create -f runtime.yaml\njuicefsruntime.data.fluid.io/jfsdemo created\n")])])]),s("p",[s("strong",[t._v("检查 "),s("code",[t._v("JuiceFSRuntime")]),t._v(" 资源对象是否已经创建")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("$ kubectl get juicefsruntime\nNAME      AGE\njfsdemo   34s\n")])])]),s("p",[t._v("等待一段时间，让 "),s("code",[t._v("JuiceFSRuntime")]),t._v(" 资源对象中的各个组件得以顺利启动，你会看到类似以下状态：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("$ kubectl get po "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" jfs\njfsdemo-worker-0                                          "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("/1     Running   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("          4m2s\n")])])]),s("p",[s("code",[t._v("JuiceFSRuntime")]),t._v(" 没有 master 组件，而 FUSE 组件实现了懒启动，会在 pod 使用时再创建。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("$ kubectl get juicefsruntime jfsdemo\nNAME      AGE\njfsdemo   6m13s\n")])])]),s("p",[t._v("然后，再查看 "),s("code",[t._v("Dataset")]),t._v(" 状态，发现已经与 "),s("code",[t._v("JuiceFSRuntime")]),t._v(" 绑定。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("$ kubectl get dataset jfsdemo\nNAME      UFS TOTAL SIZE   CACHED   CACHE CAPACITY   CACHED PERCENTAGE   PHASE   AGE\njfsdemo   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(".00KiB          -        "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("40")]),t._v(".00GiB         -                   Bound   9m28s\n")])])]),s("p",[s("strong",[t._v("查看待创建的 Pod 资源对象")]),t._v("，其中 Pod 使用上面创建的 "),s("code",[t._v("Dataset")]),t._v(" 的方式为指定同名的 PVC。")]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[t._v("$ cat<<EOF "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v("sample.yaml\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" v1\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Pod\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" demo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("app\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("containers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" demo\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nginx\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("volumeMounts")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("mountPath")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" /data\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" demo\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("volumes")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" demo\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("persistentVolumeClaim")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("claimName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" jfsdemo\nEOF\n")])])]),s("p",[s("strong",[t._v("创建 Pod 资源对象")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("$ kubectl create -f sample.yaml\npod/demo-app created\n")])])]),s("p",[s("strong",[t._v("检查 Pod 资源对象是否已经创建")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("$ kubectl get po "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" demo\ndemo-app                                                       "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("/1     Running   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("          31s\njfsdemo-fuse-fx7np                                             "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("/1     Running   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("          31s\njfsdemo-worker-0                                               "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("/1     Running   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("          10m\n")])])]),s("p",[t._v("可以看到 pod 已经创建成功，同时 JuiceFS 的 FUSE 组件也启动成功。")]),t._v(" "),s("h3",{attrs:{id:"云服务版"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#云服务版"}},[t._v("#")]),t._v(" 云服务版")]),t._v(" "),s("p",[t._v("在使用 JuiceFS 之前，您需要提供 JuiceFS 控制台管理的 Token（更多信息参考"),s("a",{attrs:{href:"https://juicefs.com/docs/zh/cloud/metadata/#%E4%BB%A4%E7%89%8C%E7%AE%A1%E7%90%86",target:"_blank",rel:"noopener noreferrer"}},[t._v("这篇文档"),s("OutboundLink")],1),t._v("），及对象存储服务（如 MinIO）的参数，并创建对应的 secret：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("kubectl create secret generic jfs-secret "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n    --from-literal"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("token"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("token"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n    --from-literal"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("access-key"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("accesskey"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n    --from-literal"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("secret-key"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("secretkey"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),s("p",[t._v("其中：")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("token")]),t._v("：JuiceFS 管理 token。更多信息参考"),s("a",{attrs:{href:"https://juicefs.com/docs/zh/cloud/metadata/#%E4%BB%A4%E7%89%8C%E7%AE%A1%E7%90%86",target:"_blank",rel:"noopener noreferrer"}},[t._v("这篇文档"),s("OutboundLink")],1),t._v("。")]),t._v(" "),s("li",[s("code",[t._v("access-key")]),t._v("：对象存储的 access key。")]),t._v(" "),s("li",[s("code",[t._v("secret-key")]),t._v("：对象存储的 secret key。")])]),t._v(" "),s("p",[s("strong",[t._v("查看待创建的 "),s("code",[t._v("Dataset")]),t._v(" 资源对象")])]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[t._v("$ cat<<EOF "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v("dataset.yaml\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" data.fluid.io/v1alpha1\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Dataset\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" jfsdemo\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("mounts")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" minio\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("mountPoint")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"juicefs:///demo"')]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("options")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("bucket")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<bucket>"')]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("encryptOptions")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" token\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("valueFrom")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("secretKeyRef")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n              "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" jfs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("secret\n              "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("key")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" token\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" access"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("key\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("valueFrom")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("secretKeyRef")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n              "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" jfs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("secret\n              "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("key")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" access"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("key\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" secret"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("key\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("valueFrom")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("secretKeyRef")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n              "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" jfs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("secret\n              "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("key")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" secret"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("key\nEOF\n")])])]),s("p",[t._v("其中：")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("name")]),t._v("：需要与在 JuiceFS 控制台创建的 volume 名一致。")]),t._v(" "),s("li",[s("code",[t._v("mountPoint")]),t._v("：指的是 JuiceFS 的子目录，是用户在 JuiceFS 文件系统中存储数据的目录，以 "),s("code",[t._v("juicefs://")]),t._v(" 开头；如 "),s("code",[t._v("juicefs:///demo")]),t._v(" 为 JuiceFS 文件系统的 "),s("code",[t._v("/demo")]),t._v(" 子目录。")]),t._v(" "),s("li",[s("code",[t._v("bucket")]),t._v("：Bucket URL。例如使用 S3 作为对象存储，bucket 为 "),s("code",[t._v("https://myjuicefs.s3.us-east-2.amazonaws.com")]),t._v("；更多信息参考"),s("a",{attrs:{href:"https://juicefs.com/docs/zh/community/how_to_setup_object_storage/",target:"_blank",rel:"noopener noreferrer"}},[t._v("这篇文档"),s("OutboundLink")],1),t._v(" 。")])]),t._v(" "),s("blockquote",[s("p",[s("strong",[t._v("注意")]),t._v("：其中 "),s("code",[t._v("name")]),t._v(" 和 "),s("code",[t._v("token")]),t._v(" 为必填项。")])]),t._v(" "),s("p",[t._v("JuiceFS 对应的 "),s("code",[t._v("Dataset")]),t._v(" 只支持一个 mount，且 JuiceFS 没有 UFS，"),s("code",[t._v("mountPoint")]),t._v(" 中可以指定需要挂载的子目录（"),s("code",[t._v("juicefs:///")]),t._v(" 为根路径），会作为根目录挂载到容器内。")]),t._v(" "),s("p",[s("strong",[t._v("创建 "),s("code",[t._v("Dataset")]),t._v(" 资源对象")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("$ kubectl create -f dataset.yaml\ndataset.data.fluid.io/jfsdemo created\n")])])]),s("p",[s("strong",[t._v("查看 "),s("code",[t._v("Dataset")]),t._v(" 资源对象状态")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("$ kubectl get dataset jfsdemo\nNAME      UFS TOTAL SIZE   CACHED   CACHE CAPACITY   CACHED PERCENTAGE   PHASE      AGE\njfsdemo                                                                  NotBound   44s\n")])])]),s("p",[t._v("如上所示，"),s("code",[t._v("status")]),t._v(" 中的 "),s("code",[t._v("phase")]),t._v(" 属性值为 "),s("code",[t._v("NotBound")]),t._v("，这意味着该 "),s("code",[t._v("Dataset")]),t._v(" 资源对象目前还未与任何 "),s("code",[t._v("JuiceFSRuntime")]),t._v(" 资源对象绑定，接下来，我们将创建一个 "),s("code",[t._v("JuiceFSRuntime")]),t._v(" 资源对象。")]),t._v(" "),s("p",[s("strong",[t._v("查看待创建的 "),s("code",[t._v("JuiceFSRuntime")]),t._v(" 资源对象")])]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[t._v("$ cat<<EOF "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v("runtime.yaml\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" data.fluid.io/v1alpha1\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" JuiceFSRuntime\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" jfsdemo\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("replicas")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("tieredstore")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("levels")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("mediumtype")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" MEM\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("path")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" /dev/shm\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("quota")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("40960")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("low")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0.1"')]),t._v("\nEOF\n")])])]),s("blockquote",[s("p",[t._v("注意：JuiceFS 中 "),s("code",[t._v("quota")]),t._v(" 的最小单位是 MiB")])]),t._v(" "),s("p",[s("strong",[t._v("创建 "),s("code",[t._v("JuiceFSRuntime")]),t._v(" 资源对象")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("$ kubectl create -f runtime.yaml\njuicefsruntime.data.fluid.io/jfsdemo created\n")])])]),s("p",[s("strong",[t._v("检查 "),s("code",[t._v("JuiceFSRuntime")]),t._v(" 资源对象是否已经创建")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("$ kubectl get juicefsruntime\nNAME      AGE\njfsdemo   34s\n")])])]),s("p",[t._v("等待一段时间，让 "),s("code",[t._v("JuiceFSRuntime")]),t._v(" 资源对象中的各个组件得以顺利启动，你会看到类似以下状态：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("$ kubectl get po "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" jfs\njfsdemo-worker-0                                           "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("/1     Running   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("          4m2s\n")])])]),s("p",[s("code",[t._v("JuiceFSRuntime")]),t._v(" 没有 master 组件，而 FUSE 组件实现了懒启动，会在 pod 使用时再创建；JuiceFS 云服务版的 worker 提供了分布式独立缓存。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("$ kubectl get juicefsruntime jfsdemo\nNAME      AGE\njfsdemo   6m13s\n")])])]),s("p",[t._v("然后，再查看 "),s("code",[t._v("Dataset")]),t._v(" 状态，发现已经与 "),s("code",[t._v("JuiceFSRuntime")]),t._v(" 绑定。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("$ kubectl get dataset jfsdemo\nNAME      UFS TOTAL SIZE   CACHED   CACHE CAPACITY   CACHED PERCENTAGE   PHASE   AGE\njfsdemo   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(".00KiB          -        "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("40")]),t._v(".00GiB         -                   Bound   9m28s\n")])])]),s("p",[s("strong",[t._v("查看待创建的 Pod 资源对象")]),t._v("，其中 Pod 使用上面创建的 "),s("code",[t._v("Dataset")]),t._v(" 的方式为指定同名的 PVC。")]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[t._v("$ cat<<EOF "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v("sample.yaml\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" v1\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Pod\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" demo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("app\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("containers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" demo\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nginx\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("volumeMounts")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("mountPath")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" /data\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" demo\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("volumes")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" demo\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("persistentVolumeClaim")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("claimName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" jfsdemo\nEOF\n")])])]),s("p",[s("strong",[t._v("创建 Pod 资源对象")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("$ kubectl create -f sample.yaml\npod/demo-app created\n")])])]),s("p",[s("strong",[t._v("检查 Pod 资源对象是否已经创建")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("$ kubectl get po "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" demo\ndemo-app                                                       "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("/1     Running   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("          31s\njfsdemo-fuse-fx7np                                             "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("/1     Running   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("          31s\njfsdemo-worker-0                                               "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("/1     Running   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("          10m\n")])])]),s("p",[t._v("可以看到 pod 已经创建成功，同时 JuiceFS 的 FUSE 组件也启动成功。")])])}),[],!1,null,null,null);s.default=n.exports}}]);