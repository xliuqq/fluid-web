(window.webpackJsonp=window.webpackJsonp||[]).push([[70],{426:function(s,e,a){"use strict";a.r(e);var t=a(19),r=Object(t.a)({},(function(){var s=this,e=s._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"fuse-pod-问题诊断"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#fuse-pod-问题诊断"}},[s._v("#")]),s._v(" FUSE Pod 问题诊断")]),s._v(" "),e("h2",{attrs:{id:"概要"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#概要"}},[s._v("#")]),s._v(" 概要")]),s._v(" "),e("p",[s._v("如果应用Pod由于CSI Plugin的问题处于长时间处于"),e("code",[s._v("ContainerCreating")]),s._v("或者"),e("code",[s._v("Pending")]),s._v("的状态无法创建，这通常是由同一个节点Fuse Pod状态不正常导致的。可以按照以下步骤进行排查")]),s._v(" "),e("h3",{attrs:{id:"查看应用pods事件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#查看应用pods事件"}},[s._v("#")]),s._v(" 查看应用Pods事件")]),s._v(" "),e("p",[s._v("调试 Fuse 的第一步是查看应用 Pod 信息。用如下命令查看 Pod 的当前状态和最近的事件：")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("kubectl describe pods "),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${POD_NAME}")]),s._v("\n")])])]),e("p",[s._v("类似以下信息，但是可能不尽相同,但是都指向FailedMount原因：")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("kubectl describe po nginx-0\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nEvents:\n  Type     Reason       Age   From               Message\n  ----     ------       ----  ----               -------\n  Normal   Scheduled    30s   default-scheduler  Successfully assigned default/nginx-0 to testnode\n  Warning  FailedMount  1s    kubelet            MountVolume.MountDevice failed "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" volume "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"default-shared-data"')]),s._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" rpc error: code "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Unknown desc "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" fuse pod on "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("node")]),s._v(" testnode is not ready\n")])])]),e("h3",{attrs:{id:"获取该应用pod对应fuse-pod的信息"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#获取该应用pod对应fuse-pod的信息"}},[s._v("#")]),s._v(" 获取该应用Pod对应Fuse Pod的信息")]),s._v(" "),e("p",[s._v("此时需要查看此节点的Fuse Pod的状态，首先用如下命令获取该当前应用Pod所在的节点信息, NODE列对应的输出就是应用Pod所在的节点")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("kubectl get pods "),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${POD_NAME}")]),s._v(" -owide\n")])])]),e("p",[s._v("例如，以下Fuse Pod所在的节点为testnode:")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("kubectl get pods  nginx-0 -owide\nNAME      READY   STATUS              RESTARTS   AGE   IP       NODE                       NOMINATED NODE   READINESS GATES\nnginx-0   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("/1     ContainerCreating   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          17m   "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("   testnode   "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("           "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])])]),e("p",[s._v("定位该Fuse Pod具体信息")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v(" kubectl get po -owide "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${NODE_NAME}")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" -i fuse\n")])])]),e("p",[s._v("例如，以下例子中，该Fuse Pod为 "),e("code",[s._v("shared-data-alluxio-fuse-w6lcp")]),s._v("， 可以看到该Pod处于失败的状态")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("kubectl get po -owide "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" testnode "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" fuse\nshared-data-alluxio-fuse-w6lcp   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("/1     CrashLoopBackOff    "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("         29m   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.233   testnode   "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("           "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])])]),e("h3",{attrs:{id:"排查该fuse-pod"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#排查该fuse-pod"}},[s._v("#")]),s._v(" 排查该Fuse Pod")]),s._v(" "),e("p",[s._v("可以按照"),e("a",{attrs:{href:"https://kubernetes.io/zh/docs/tasks/debug-application-cluster/debug-running-pod/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Kubernetes文档"),e("OutboundLink")],1),s._v("排查该Fuse Pod的问题。")])])}),[],!1,null,null,null);e.default=r.exports}}]);